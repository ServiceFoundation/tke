---
kind: Deployment
apiVersion: apps/v1
metadata:
  labels:
    app: tke-auth-controller
  name: tke-auth-controller
  namespace: tke
spec:
  replicas: {{ .Replicas }}
  selector:
    matchLabels:
      app: tke-auth-controller
  template:
    metadata:
      labels:
        app: tke-auth-controller
    spec:
      containers:
        - name: tke-auth-controller
          image: {{ .Image }}
          args:
            - -C=/app/conf/tke-auth-controller.toml
          volumeMounts:
            - name: certs-volume
              mountPath: /app/certs
            - name: tke-auth-controller-volume
              mountPath: /app/conf
          ports:
            - containerPort: 9458
          livenessProbe:
            httpGet:
              port: 9458
              path: /healthz
              scheme: HTTPS
            initialDelaySeconds: 15
            periodSeconds: 20
          resources:
            limits:
              cpu: 500m
              memory: 1Gi
            requests:
              cpu: 250m
              memory: 256Mi
      volumes:
        - name: certs-volume
          configMap:
            name: certs
        - name: tke-auth-controller-volume
          configMap:
            name: tke-auth-controller
---
kind: ConfigMap
apiVersion: v1
metadata:
  name: tke-auth-controller
  namespace: tke
data:
  policy.json: |
    [{"metadata":{"creationTimestamp":null},"spec":{"displayName":"AddonFullAccess","tenantID":"default","category":"addon","type":"default","username":"","description":"该策略允许您管理平台租户内扩展组件相关资源，如Helm，prometheus等","statement":{"actions":["*Addon*","*Addons*","*Csioperator*","*Csioperators*","*Ipam*","*Ipams*","*Tappcontroller*","*Tappcontrollers*","*Logc*","*Logcs*","*Galaxy*","*Galaxies*","*Logcollector*","*Logcollectors*","*Addontype*","*Addontypes*","*Csi*","*Csis*","*Clusteraddontype*","*Clusteraddontypes*","*Coredns*","*Cronhpa*","*Cronhpas*","*Lbcf*","*Lbcfs*","*Helm*","*Helms*","*Persistentevent*","*Persistentevents*","*Gpumanager*","*Gpumanagers*","*Prometheuse*","*Prometheuses*","*Volumedecorator*","*Volumedecorators*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"ConfigFullAccess","tenantID":"default","category":"config","type":"default","username":"","description":"该策略允许您管理平台租户k8s配置组资源，包括configmap、secret等","statement":{"actions":["*Configmap*","*Configmaps*","*Secret*","*Secrets*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"NotifyFullAccess","tenantID":"default","category":"notify","type":"default","username":"","description":"该策略允许您管理平台租户通知设置","statement":{"actions":["*Receiver*","*Receivers*","*Messagerequest*","*Messagerequests*","*Channel*","*Channels*","*Receivergroup*","*Receivergroups*","*Template*","*Templates*","*Message*","*Messages*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"NetworkFullAccess","tenantID":"default","category":"network","type":"default","username":"","description":"该策略允许您管理平台租户内网络资源，如网络策略，service，ignress等","statement":{"actions":["*Networkpolicy*","*Networkpolicies*","*Ingress*","*Ingresses*","*Lbcflb*","*Lbcflbs*","*Service*","*Services*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"VolumeFullAccess","tenantID":"default","category":"volume","type":"default","username":"","description":"该策略允许您管理平台租户云盘资源","statement":{"actions":["*Persistentvolume*","*Persistentvolumes*","*Storageclass*","*Storageclasses*","*Persistentvolumeclaim*","*Persistentvolumeclaims*","*Volumeattachment*","*Volumeattachments*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"RegistryFullAccess","tenantID":"default","category":"registry","type":"default","username":"","description":"该策略允许您管理平台租户镜像仓库资源","statement":{"actions":["*Repository*","*Repositories*","*Chartgroup*","*Chartgroups*","*Registrynamespace*","*Registrynamespaces*","*Registry*","*Registries*","*Chart*","*Charts*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"MonitorFullAccess","tenantID":"default","category":"monitor","type":"default","username":"","description":"该策略允许您管理平台租户监控告警策略","statement":{"actions":["*Metric*","*Metrics*","*Alarmpolicy*","*Alarmpolicies*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"AuthFullAccess","tenantID":"default","category":"auth","type":"default","username":"","description":"该策略允许您管理平台租户内所有用户及其权限","statement":{"actions":["*Rolebinding*","*Rolebindings*","*Apikey*","*Apikeys*","*User*","*Users*","*Category*","*Categories*","*Permission*","*Permissions*","*Role*","*Roles*","*Clusterrole*","*Clusterroles*","*Localgroup*","*Localgroups*","*Client*","*Clients*","*Policy*","*Policies*","*Identityprovider*","*Identityproviders*","*Clusterrolebinding*","*Clusterrolebindings*","*Group*","*Groups*","*Localidentity*","*Localidentities*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"ClusterFullAccess","tenantID":"default","category":"cluster","type":"default","username":"","description":"该策略允许您管理平台租户内集群相关的资源, 包括集群管理、节点和优先级等","statement":{"actions":["*Runtimeclass*","*Runtimeclasses*","*Node*","*Nodes*","*Cluster*","*Clusters*","*Clustercredential*","*Clustercredentials*","*Machine*","*Machines*","*Apply*","*Applies*","*Priorityclass*","*Priorityclasses*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"ProjectFullAccess","tenantID":"default","category":"project","type":"default","username":"","description":"该策略允许您管理平台租户业务业务相关资源","statement":{"actions":["*Platform*","*Platforms*","*Resourcequota*","*Portal*","*Portals*","*Namespace*","*Namespaces*","*Event*","*Events*","*Project*","*Projects*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"AdministratorAccess","tenantID":"default","category":"common","type":"default","username":"","description":"该策略允许管理平台租户内所有用户及其权限、容器服务资产","statement":{"actions":["*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}},{"metadata":{"creationTimestamp":null},"spec":{"displayName":"ReadOnlyAccess","tenantID":"default","category":"common","type":"default","username":"","description":"该策略允许您只读访问账户内所有支持接口级鉴权或资源级鉴权的容器服务资产","statement":{"actions":["get*","list*","watch*"],"resources":["*"],"effect":"allow"}},"status":{"phase":"","users":null,"groups":null}}]
  category.json: |
    [{"metadata":{"name":"project","creationTimestamp":null},"Spec":{"displayName":"业务和命名空间","description":"业务和命名空间","actions":[{"name":"createEvent","description":"创建事件"},{"name":"createNamespace","description":"创建命名空间"},{"name":"createPlatform","description":"创建平台"},{"name":"createProject","description":"创建业务"},{"name":"createResourcequota","description":"创建资源配额"},{"name":"deleteEvent","description":"删除事件"},{"name":"deleteNamespace","description":"删除命名空间"},{"name":"deletePlatform","description":"删除平台"},{"name":"deleteProject","description":"删除业务"},{"name":"deleteResourcequota","description":"删除资源配额"},{"name":"getEvent","description":"获取事件"},{"name":"getNamespace","description":"获取命名空间"},{"name":"getNamespaceStatus","description":"获取命名空间状态"},{"name":"getPlatform","description":"获取平台"},{"name":"getProject","description":"获取业务"},{"name":"getProjectStatus","description":"获取业务状态"},{"name":"getResourcequota","description":"获取资源配额"},{"name":"getResourcequotaStatus","description":"获取资源配额状态"},{"name":"listEvents","description":"列举事件"},{"name":"listNamespaces","description":"列举命名空间"},{"name":"listPlatforms","description":"列举平台"},{"name":"listPortal","description":"列举Portal"},{"name":"listProjects","description":"列举业务"},{"name":"listResourcequotas","description":"列举资源配额"},{"name":"updateEvent","description":"修改事件"},{"name":"updateNamespace","description":"修改命名空间"},{"name":"updateNamespaceStatus","description":"修改命名空间状态"},{"name":"updatePlatform","description":"修改平台"},{"name":"updateProject","description":"修改业务"},{"name":"updateProjectStatus","description":"修改业务状态"},{"name":"updateResourcequota","description":"修改资源配额"},{"name":"updateResourcequotaStatus","description":"修改资源配额状态"}]}},{"metadata":{"name":"monitor","creationTimestamp":null},"Spec":{"displayName":"监控告警","description":"监控告警","actions":[{"name":"createAlarmpolicy","description":"创建告警策略"},{"name":"createMetric","description":"创建Metric"},{"name":"deleteAlarmpolicy","description":"删除告警策略"},{"name":"getAlarmpolicy","description":"获取告警策略"},{"name":"getMetric","description":"获取Metric"},{"name":"listAlarmpolicies","description":"列举告警策略"},{"name":"listMetrics","description":"列举Metric"},{"name":"updateAlarmpolicy","description":"修改告警策略"}]}},{"metadata":{"name":"notify","creationTimestamp":null},"Spec":{"displayName":"通知服务","description":"通知服务","actions":[{"name":"createChannel","description":"创建通知渠道"},{"name":"createMessage","description":"创建消息"},{"name":"createMessagerequest","description":"创建消息请求"},{"name":"createReceiver","description":"创建接收人"},{"name":"createReceivergroup","description":"创建接收人组"},{"name":"createTemplate","description":"创建消息模板"},{"name":"deleteChannel","description":"删除通知渠道"},{"name":"deleteMessage","description":"删除消息"},{"name":"deleteMessagerequest","description":"删除消息请求"},{"name":"deleteReceiver","description":"删除接收人"},{"name":"deleteReceivergroup","description":"删除接收人组"},{"name":"deleteTemplate","description":"删除消息模板"},{"name":"getChannel","description":"获取通知渠道"},{"name":"getChannelStatus","description":"获取通知渠道状态"},{"name":"getMessage","description":"获取消息"},{"name":"getMessageStatus","description":"获取消息状态"},{"name":"getMessagerequest","description":"获取消息请求"},{"name":"getMessagerequestStatus","description":"获取消息请求状态"},{"name":"getReceiver","description":"获取接收人"},{"name":"getReceivergroup","description":"获取接收人组"},{"name":"getTemplate","description":"获取消息模板"},{"name":"listChannels","description":"列举通知渠道"},{"name":"listMessagerequests","description":"列举消息请求"},{"name":"listMessages","description":"列举消息"},{"name":"listReceivergroups","description":"列举接收人组"},{"name":"listReceivers","description":"列举接收人"},{"name":"listTemplates","description":"列举消息模板"},{"name":"updateChannel","description":"修改通知渠道"},{"name":"updateChannelStatus","description":"修改通知渠道状态"},{"name":"updateMessage","description":"修改消息"},{"name":"updateMessageStatus","description":"修改消息状态"},{"name":"updateMessagerequest","description":"修改消息请求"},{"name":"updateMessagerequestStatus","description":"修改消息请求状态"},{"name":"updateReceiver","description":"修改接收人"},{"name":"updateReceivergroup","description":"修改接收人组"},{"name":"updateTemplate","description":"修改消息模板"}]}},{"metadata":{"name":"registry","creationTimestamp":null},"Spec":{"displayName":"镜像仓库","description":"镜像仓库","actions":[{"name":"createChart","description":"创建Chart"},{"name":"createChartgroup","description":"创建Chartgroup"},{"name":"createRegistry","description":"创建Registry"},{"name":"createRegistrynamespace","description":"创建Registrynamespace"},{"name":"createRepository","description":"创建Repository"},{"name":"deleteChart","description":"删除Chart"},{"name":"deleteChartgroup","description":"删除Chartgroup"},{"name":"deleteRegistry","description":"删除Registry"},{"name":"deleteRegistrynamespace","description":"删除Registrynamespace"},{"name":"deleteRepository","description":"删除Repository"},{"name":"getChart","description":"获取Chart"},{"name":"getChartStatus","description":"获取Chart状态"},{"name":"getChartgroup","description":"获取Chartgroup"},{"name":"getChartgroupStatus","description":"获取Chartgroup状态"},{"name":"getRegistry","description":"获取Registry"},{"name":"getRegistrynamespace","description":"获取Registrynamespace"},{"name":"getRegistrynamespaceStatus","description":"获取Registrynamespace状态"},{"name":"getRepository","description":"获取Repository"},{"name":"getRepositoryStatus","description":"获取Repository状态"},{"name":"listChartgroups","description":"列举Chartgroup"},{"name":"listCharts","description":"列举Chart"},{"name":"listRegistries","description":"列举Registry"},{"name":"listRegistrynamespaces","description":"列举Registrynamespace"},{"name":"listRepositories","description":"列举Repository"},{"name":"updateChart","description":"修改Chart"},{"name":"updateChartStatus","description":"修改Chart状态"},{"name":"updateChartgroup","description":"修改Chartgroup"},{"name":"updateChartgroupStatus","description":"修改Chartgroup状态"},{"name":"updateRegistry","description":"修改Registry"},{"name":"updateRegistrynamespace","description":"修改Registrynamespace"},{"name":"updateRegistrynamespaceStatus","description":"修改Registrynamespace状态"},{"name":"updateRepository","description":"修改Repository"},{"name":"updateRepositoryStatus","description":"修改Repository状态"}]}},{"metadata":{"name":"cluster","creationTimestamp":null},"Spec":{"displayName":"集群管理","description":"集群管理","actions":[{"name":"createCluster","description":"创建集群"},{"name":"createClustercredential","description":"创建集群凭据"},{"name":"createMachine","description":"创建机器"},{"name":"createNode","description":"创建节点"},{"name":"createPriorityclass","description":"创建优先级"},{"name":"createRuntimeclass","description":"创建Runtimeclass"},{"name":"deleteCluster","description":"删除集群"},{"name":"deleteClustercredential","description":"删除集群凭据"},{"name":"deleteMachine","description":"删除机器"},{"name":"deleteNode","description":"删除节点"},{"name":"deletePriorityclass","description":"删除优先级"},{"name":"deleteRuntimeclass","description":"删除Runtimeclass"},{"name":"getCluster","description":"获取集群"},{"name":"getClusterStatus","description":"获取集群状态"},{"name":"getClustercredential","description":"获取集群凭据"},{"name":"getMachine","description":"获取机器"},{"name":"getMachineStatus","description":"获取机器状态"},{"name":"getNode","description":"获取节点"},{"name":"getNodeStatus","description":"获取节点状态"},{"name":"getPriorityclass","description":"获取优先级"},{"name":"getRuntimeclass","description":"获取Runtimeclass"},{"name":"listClustercredentials","description":"列举集群凭据"},{"name":"listClusters","description":"列举集群"},{"name":"listMachines","description":"列举机器"},{"name":"listNodes","description":"列举节点"},{"name":"listPriorityclasses","description":"列举优先级"},{"name":"listRuntimeclasses","description":"列举Runtimeclass"},{"name":"updateCluster","description":"修改集群"},{"name":"updateClusterStatus","description":"修改集群状态"},{"name":"updateClustercredential","description":"修改集群凭据"},{"name":"updateMachine","description":"修改机器"},{"name":"updateMachineStatus","description":"修改机器状态"},{"name":"updateNode","description":"修改节点"},{"name":"updateNodeStatus","description":"修改节点状态"},{"name":"updatePriorityclass","description":"修改优先级"},{"name":"updateRuntimeclass","description":"修改Runtimeclass"}]}},{"metadata":{"name":"application","creationTimestamp":null},"Spec":{"displayName":"应用管理","description":"应用管理","actions":[{"name":"createBinding","description":"创建Binding"},{"name":"createCertificatesigningrequest","description":"创建证书签名请求"},{"name":"createControllerrevision","description":"创建Controllerrevision"},{"name":"createCronjob","description":"创建周期作业"},{"name":"createDaemonset","description":"创建守护作业集"},{"name":"createDeployment","description":"创建微服务"},{"name":"createDeploymentRollback","description":"创建微服务Rollback"},{"name":"createEndpoint","description":"创建端点"},{"name":"createHorizontalpodautoscaler","description":"创建pod水平伸缩器"},{"name":"createJob","description":"创建作业"},{"name":"createLease","description":"创建Lease"},{"name":"createLimitrange","description":"创建Limitrange"},{"name":"createMutatingwebhookconfiguration","description":"创建MutatingWebhook配置"},{"name":"createPod","description":"创建Pod"},{"name":"createPodBinding","description":"创建PodBinding"},{"name":"createPoddisruptionbudget","description":"创建Poddisruptionbudget"},{"name":"createPodpreset","description":"创建Podpreset"},{"name":"createPodsecuritypolicy","description":"创建pod安全策略"},{"name":"createPodtemplate","description":"创建pod模板"},{"name":"createReplicaset","description":"创建副本集"},{"name":"createReplicationcontroller","description":"创建副本控制器"},{"name":"createServiceaccount","description":"创建服务账户"},{"name":"createStatefulset","description":"创建有状态服务集"},{"name":"createValidatingwebhookconfiguration","description":"创建ValidatingWebhook配置"},{"name":"deleteCertificatesigningrequest","description":"删除证书签名请求"},{"name":"deleteControllerrevision","description":"删除Controllerrevision"},{"name":"deleteCronjob","description":"删除周期作业"},{"name":"deleteDaemonset","description":"删除守护作业集"},{"name":"deleteDeployment","description":"删除微服务"},{"name":"deleteEndpoint","description":"删除端点"},{"name":"deleteHorizontalpodautoscaler","description":"删除pod水平伸缩器"},{"name":"deleteJob","description":"删除作业"},{"name":"deleteLease","description":"删除Lease"},{"name":"deleteLimitrange","description":"删除Limitrange"},{"name":"deleteMutatingwebhookconfiguration","description":"删除MutatingWebhook配置"},{"name":"deletePod","description":"删除Pod"},{"name":"deletePoddisruptionbudget","description":"删除Poddisruptionbudget"},{"name":"deletePodpreset","description":"删除Podpreset"},{"name":"deletePodsecuritypolicy","description":"删除pod安全策略"},{"name":"deletePodtemplate","description":"删除pod模板"},{"name":"deleteReplicaset","description":"删除副本集"},{"name":"deleteReplicationcontroller","description":"删除副本控制器"},{"name":"deleteServiceaccount","description":"删除服务账户"},{"name":"deleteStatefulset","description":"删除有状态服务集"},{"name":"deleteValidatingwebhookconfiguration","description":"删除ValidatingWebhook配置"},{"name":"getCertificatesigningrequest","description":"获取证书签名请求"},{"name":"getComponentstatus","description":"获取Componentstatus"},{"name":"getControllerrevision","description":"获取Controllerrevision"},{"name":"getCronjob","description":"获取周期作业"},{"name":"getCronjobStatus","description":"获取周期作业状态"},{"name":"getDaemonset","description":"获取守护作业集"},{"name":"getDaemonsetStatus","description":"获取守护作业集状态"},{"name":"getDeployment","description":"获取微服务"},{"name":"getDeploymentStatus","description":"获取微服务状态"},{"name":"getEndpoint","description":"获取端点"},{"name":"getHorizontalpodautoscaler","description":"获取pod水平伸缩器"},{"name":"getHorizontalpodautoscalerStatus","description":"获取pod水平伸缩器状态"},{"name":"getJob","description":"获取作业"},{"name":"getJobStatus","description":"获取作业状态"},{"name":"getLease","description":"获取Lease"},{"name":"getLimitrange","description":"获取Limitrange"},{"name":"getMutatingwebhookconfiguration","description":"获取MutatingWebhook配置"},{"name":"getPod","description":"获取Pod"},{"name":"getPodLog","description":"获取Pod日志"},{"name":"getPodStatus","description":"获取Pod状态"},{"name":"getPoddisruptionbudget","description":"获取Poddisruptionbudget"},{"name":"getPoddisruptionbudgetStatus","description":"获取Poddisruptionbudget状态"},{"name":"getPodpreset","description":"获取Podpreset"},{"name":"getPodsecuritypolicy","description":"获取pod安全策略"},{"name":"getPodtemplate","description":"获取pod模板"},{"name":"getReplicaset","description":"获取副本集"},{"name":"getReplicasetStatus","description":"获取副本集状态"},{"name":"getReplicationcontroller","description":"获取副本控制器"},{"name":"getReplicationcontrollerStatus","description":"获取副本控制器状态"},{"name":"getServiceaccount","description":"获取服务账户"},{"name":"getStatefulset","description":"获取有状态服务集"},{"name":"getStatefulsetStatus","description":"获取有状态服务集状态"},{"name":"getValidatingwebhookconfiguration","description":"获取ValidatingWebhook配置"},{"name":"listCertificatesigningrequests","description":"列举证书签名请求"},{"name":"listComponentstatuses","description":"列举Componentstatus"},{"name":"listControllerrevisions","description":"列举Controllerrevision"},{"name":"listCronjobEvents","description":"列举周期作业事件"},{"name":"listCronjobs","description":"列举周期作业"},{"name":"listDaemonsetEvents","description":"列举守护作业集事件"},{"name":"listDaemonsetPods","description":"列举守护作业集Pod"},{"name":"listDaemonsets","description":"列举守护作业集"},{"name":"listDeploymentEvents","description":"列举微服务事件"},{"name":"listDeploymentHorizontalpodautoscalers","description":"列举微服务pod水平伸缩器"},{"name":"listDeploymentPods","description":"列举微服务Pod"},{"name":"listDeploymentScale","description":"列举微服务Scale"},{"name":"listDeployments","description":"列举微服务"},{"name":"listEndpoints","description":"列举端点"},{"name":"listHorizontalpodautoscalerEvents","description":"列举pod水平伸缩器事件"},{"name":"listHorizontalpodautoscalers","description":"列举pod水平伸缩器"},{"name":"listJobEvents","description":"列举作业事件"},{"name":"listJobPods","description":"列举作业Pod"},{"name":"listJobs","description":"列举作业"},{"name":"listLeases","description":"列举Lease"},{"name":"listLimitranges","description":"列举Limitrange"},{"name":"listMutatingwebhookconfigurations","description":"列举MutatingWebhook配置"},{"name":"listPodEvents","description":"列举Pod事件"},{"name":"listPoddisruptionbudgets","description":"列举Poddisruptionbudget"},{"name":"listPodpresets","description":"列举Podpreset"},{"name":"listPods","description":"列举Pod"},{"name":"listPodsecuritypolicies","description":"列举pod安全策略"},{"name":"listPodtemplates","description":"列举pod模板"},{"name":"listReplicasetEvents","description":"列举副本集事件"},{"name":"listReplicasetPods","description":"列举副本集Pod"},{"name":"listReplicasetScale","description":"列举副本集Scale"},{"name":"listReplicasets","description":"列举副本集"},{"name":"listReplicationcontrollerEvents","description":"列举副本控制器事件"},{"name":"listReplicationcontrollerPods","description":"列举副本控制器Pod"},{"name":"listReplicationcontrollerScale","description":"列举副本控制器Scale"},{"name":"listReplicationcontrollers","description":"列举副本控制器"},{"name":"listServiceaccounts","description":"列举服务账户"},{"name":"listStatefulsetEvents","description":"列举有状态服务集事件"},{"name":"listStatefulsetPods","description":"列举有状态服务集Pod"},{"name":"listStatefulsetScale","description":"列举有状态服务集Scale"},{"name":"listStatefulsets","description":"列举有状态服务集"},{"name":"listValidatingwebhookconfigurations","description":"列举ValidatingWebhook配置"},{"name":"updateCertificatesigningrequest","description":"修改证书签名请求"},{"name":"updateControllerrevision","description":"修改Controllerrevision"},{"name":"updateCronjob","description":"修改周期作业"},{"name":"updateCronjobStatus","description":"修改周期作业状态"},{"name":"updateDaemonset","description":"修改守护作业集"},{"name":"updateDaemonsetStatus","description":"修改守护作业集状态"},{"name":"updateDeployment","description":"修改微服务"},{"name":"updateDeploymentScale","description":"修改微服务Scale"},{"name":"updateDeploymentStatus","description":"修改微服务状态"},{"name":"updateEndpoint","description":"修改端点"},{"name":"updateHorizontalpodautoscaler","description":"修改pod水平伸缩器"},{"name":"updateHorizontalpodautoscalerStatus","description":"修改pod水平伸缩器状态"},{"name":"updateJob","description":"修改作业"},{"name":"updateJobStatus","description":"修改作业状态"},{"name":"updateLease","description":"修改Lease"},{"name":"updateLimitrange","description":"修改Limitrange"},{"name":"updateMutatingwebhookconfiguration","description":"修改MutatingWebhook配置"},{"name":"updatePod","description":"修改Pod"},{"name":"updatePodStatus","description":"修改Pod状态"},{"name":"updatePoddisruptionbudget","description":"修改Poddisruptionbudget"},{"name":"updatePoddisruptionbudgetStatus","description":"修改Poddisruptionbudget状态"},{"name":"updatePodpreset","description":"修改Podpreset"},{"name":"updatePodsecuritypolicy","description":"修改pod安全策略"},{"name":"updatePodtemplate","description":"修改pod模板"},{"name":"updateReplicaset","description":"修改副本集"},{"name":"updateReplicasetScale","description":"修改副本集Scale"},{"name":"updateReplicasetStatus","description":"修改副本集状态"},{"name":"updateReplicationcontroller","description":"修改副本控制器"},{"name":"updateReplicationcontrollerScale","description":"修改副本控制器Scale"},{"name":"updateReplicationcontrollerStatus","description":"修改副本控制器状态"},{"name":"updateServiceaccount","description":"修改服务账户"},{"name":"updateStatefulset","description":"修改有状态服务集"},{"name":"updateStatefulsetScale","description":"修改有状态服务集Scale"},{"name":"updateStatefulsetStatus","description":"修改有状态服务集状态"},{"name":"updateValidatingwebhookconfiguration","description":"修改ValidatingWebhook配置"}]}},{"metadata":{"name":"config","creationTimestamp":null},"Spec":{"displayName":"配置组管理","description":"配置组管理","actions":[{"name":"createConfigmap","description":"创建配置组"},{"name":"createSecret","description":"创建密钥"},{"name":"deleteConfigmap","description":"删除配置组"},{"name":"deleteSecret","description":"删除密钥"},{"name":"getConfigmap","description":"获取配置组"},{"name":"getSecret","description":"获取密钥"},{"name":"listConfigmaps","description":"列举配置组"},{"name":"listSecrets","description":"列举密钥"},{"name":"updateConfigmap","description":"修改配置组"},{"name":"updateSecret","description":"修改密钥"}]}},{"metadata":{"name":"network","creationTimestamp":null},"Spec":{"displayName":"网络管理","description":"网络管理","actions":[{"name":"createIngress","description":"创建Ingress"},{"name":"createNetworkpolicy","description":"创建网络策略"},{"name":"createService","description":"创建服务"},{"name":"deleteIngress","description":"删除Ingress"},{"name":"deleteNetworkpolicy","description":"删除网络策略"},{"name":"deleteService","description":"删除服务"},{"name":"getIngress","description":"获取Ingress"},{"name":"getIngressStatus","description":"获取Ingress状态"},{"name":"getNetworkpolicy","description":"获取网络策略"},{"name":"getService","description":"获取服务"},{"name":"getServiceStatus","description":"获取服务状态"},{"name":"listIngressEvents","description":"列举Ingress事件"},{"name":"listIngresses","description":"列举Ingress"},{"name":"listNetworkpolicies","description":"列举网络策略"},{"name":"listServiceEvents","description":"列举服务事件"},{"name":"listServices","description":"列举服务"},{"name":"updateIngress","description":"修改Ingress"},{"name":"updateIngressStatus","description":"修改Ingress状态"},{"name":"updateNetworkpolicy","description":"修改网络策略"},{"name":"updateService","description":"修改服务"},{"name":"updateServiceStatus","description":"修改服务状态"}]}},{"metadata":{"name":"addon","creationTimestamp":null},"Spec":{"displayName":"扩展组件管理","description":"扩展组件管理","actions":[{"name":"createCronhpa","description":"创建CronHPA组件"},{"name":"createCsioperator","description":"创建CSIOperator组件"},{"name":"createGpumanager","description":"创建GPUManager组件"},{"name":"createHelm","description":"创建Helm组件"},{"name":"createIpam","description":"创建IPAM组件"},{"name":"createLbcf","description":"创建LBCF组件"},{"name":"createLogcollector","description":"创建日志收集器组件"},{"name":"createPersistentevent","description":"创建事件持久化组件"},{"name":"createPrometheuse","description":"创建Prometheuse组件"},{"name":"createTappcontroller","description":"创建TappController组件"},{"name":"createVolumedecorator","description":"创建Volumedecorator组件"},{"name":"deleteCronhpa","description":"删除CronHPA组件"},{"name":"deleteCsioperator","description":"删除CSIOperator组件"},{"name":"deleteGpumanager","description":"删除GPUManager组件"},{"name":"deleteHelm","description":"删除Helm组件"},{"name":"deleteIpam","description":"删除IPAM组件"},{"name":"deleteLbcf","description":"删除LBCF组件"},{"name":"deleteLogcollector","description":"删除日志收集器组件"},{"name":"deletePersistentevent","description":"删除事件持久化组件"},{"name":"deletePrometheuse","description":"删除Prometheuse组件"},{"name":"deleteTappcontroller","description":"删除TappController组件"},{"name":"deleteVolumedecorator","description":"删除Volumedecorator组件"},{"name":"getClusteraddontype","description":"获取集群扩展类型"},{"name":"getCronhpa","description":"获取CronHPA组件"},{"name":"getCronhpaStatus","description":"获取CronHPA组件状态"},{"name":"getCsioperator","description":"获取CSIOperator组件"},{"name":"getCsioperatorStatus","description":"获取CSIOperator组件状态"},{"name":"getGpumanager","description":"获取GPUManager组件"},{"name":"getGpumanagerStatus","description":"获取GPUManager组件状态"},{"name":"getHelm","description":"获取Helm组件"},{"name":"getHelmStatus","description":"获取Helm组件状态"},{"name":"getIpam","description":"获取IPAM组件"},{"name":"getIpamStatus","description":"获取IPAM组件状态"},{"name":"getLbcf","description":"获取LBCF组件"},{"name":"getLbcfStatus","description":"获取LBCF组件状态"},{"name":"getLogcollector","description":"获取日志收集器组件"},{"name":"getLogcollectorStatus","description":"获取日志收集器组件状态"},{"name":"getPersistentevent","description":"获取事件持久化组件"},{"name":"getPersistenteventStatus","description":"获取事件持久化组件状态"},{"name":"getPrometheuse","description":"获取Prometheuse组件"},{"name":"getPrometheuseStatus","description":"获取Prometheuse组件状态"},{"name":"getTappcontroller","description":"获取TappController组件"},{"name":"getTappcontrollerStatus","description":"获取TappController组件状态"},{"name":"getVolumedecorator","description":"获取Volumedecorator组件"},{"name":"getVolumedecoratorStatus","description":"获取Volumedecorator组件状态"},{"name":"listClusteraddontypes","description":"列举集群扩展类型"},{"name":"listCronhpas","description":"列举CronHPA组件"},{"name":"listCsioperators","description":"列举CSIOperator组件"},{"name":"listGpumanagers","description":"列举GPUManager组件"},{"name":"listHelms","description":"列举Helm组件"},{"name":"listIpams","description":"列举IPAM组件"},{"name":"listLbcfs","description":"列举LBCF组件"},{"name":"listLogcollectors","description":"列举日志收集器组件"},{"name":"listPersistentevents","description":"列举事件持久化组件"},{"name":"listPrometheuses","description":"列举Prometheuse组件"},{"name":"listTappcontrollers","description":"列举TappController组件"},{"name":"listVolumedecorators","description":"列举Volumedecorator组件"},{"name":"updateCronhpa","description":"修改CronHPA组件"},{"name":"updateCronhpaStatus","description":"修改CronHPA组件状态"},{"name":"updateCsioperator","description":"修改CSIOperator组件"},{"name":"updateCsioperatorStatus","description":"修改CSIOperator组件状态"},{"name":"updateGpumanager","description":"修改GPUManager组件"},{"name":"updateGpumanagerStatus","description":"修改GPUManager组件状态"},{"name":"updateHelm","description":"修改Helm组件"},{"name":"updateHelmStatus","description":"修改Helm组件状态"},{"name":"updateIpam","description":"修改IPAM组件"},{"name":"updateIpamStatus","description":"修改IPAM组件状态"},{"name":"updateLbcf","description":"修改LBCF组件"},{"name":"updateLbcfStatus","description":"修改LBCF组件状态"},{"name":"updateLogcollector","description":"修改日志收集器组件"},{"name":"updateLogcollectorStatus","description":"修改日志收集器组件状态"},{"name":"updatePersistentevent","description":"修改事件持久化组件"},{"name":"updatePersistenteventStatus","description":"修改事件持久化组件状态"},{"name":"updatePrometheuse","description":"修改Prometheuse组件"},{"name":"updatePrometheuseStatus","description":"修改Prometheuse组件状态"},{"name":"updateTappcontroller","description":"修改TappController组件"},{"name":"updateTappcontrollerStatus","description":"修改TappController组件状态"},{"name":"updateVolumedecorator","description":"修改Volumedecorator组件"},{"name":"updateVolumedecoratorStatus","description":"修改Volumedecorator组件状态"}]}},{"metadata":{"name":"auth","creationTimestamp":null},"Spec":{"displayName":"用户和权限","description":"用户和权限管理","actions":[{"name":"createApikey","description":"创建访问凭证"},{"name":"createApikeyPassword","description":"使用密码申请访问凭证"},{"name":"createApikeyToken","description":"使用Token申请访问凭证"},{"name":"createClusterrole","description":"创建K8S集群角色"},{"name":"createClusterrolebinding","description":"创建K8S集群角色绑定"},{"name":"createGroup","description":"创建用户组"},{"name":"createIdentityprovider","description":"创建IDP"},{"name":"createLocalgroup","description":"创建用户组"},{"name":"createLocalgroupBinding","description":"创建用户组Binding"},{"name":"createLocalgroupUnbinding","description":"创建用户组Unbinding"},{"name":"createLocalidentity","description":"创建用户"},{"name":"createLocalidentityPassword","description":"用户修改密码"},{"name":"createPolicy","description":"创建策略"},{"name":"createPolicyBinding","description":"绑定策略用户和用户组"},{"name":"createPolicyUnbinding","description":"移除策略用户或用户组"},{"name":"createRole","description":"创建角色"},{"name":"createRoleBinding","description":"绑定角色用户和用户组"},{"name":"createRolePolicybinding","description":"添加角色策略"},{"name":"createRolePolicyunbinding","description":"移除角色策略"},{"name":"createRoleUnbinding","description":"移除角色用户或用户组"},{"name":"createRolebinding","description":"创建K8S角色绑定"},{"name":"createUser","description":"创建用户"},{"name":"deleteApikey","description":"删除访问凭证"},{"name":"deleteClusterrole","description":"删除K8S集群角色"},{"name":"deleteClusterrolebinding","description":"删除K8S集群角色绑定"},{"name":"deleteIdentityprovider","description":"删除IDP"},{"name":"deleteLocalgroup","description":"删除用户组"},{"name":"deleteLocalidentity","description":"删除用户"},{"name":"deletePolicy","description":"删除策略"},{"name":"deleteRole","description":"删除角色"},{"name":"deleteRolebinding","description":"删除K8S角色绑定"},{"name":"getApikey","description":"获取访问凭证"},{"name":"getApikeyStatus","description":"获取访问凭证状态"},{"name":"getClusterrole","description":"获取K8S集群角色"},{"name":"getClusterrolebinding","description":"获取K8S集群角色绑定"},{"name":"getGroup","description":"获取用户组"},{"name":"getIdentityprovider","description":"获取IDP"},{"name":"getLocalgroup","description":"获取用户组"},{"name":"getLocalgroupStatus","description":"获取用户组状态"},{"name":"getLocalidentity","description":"获取用户"},{"name":"getLocalidentityStatus","description":"获取用户状态"},{"name":"getPolicy","description":"获取策略"},{"name":"getPolicyStatus","description":"获取策略状态"},{"name":"getRole","description":"获取角色"},{"name":"getRoleStatus","description":"获取角色状态"},{"name":"getRolebinding","description":"获取K8S角色绑定"},{"name":"getUser","description":"获取用户"},{"name":"listApikeys","description":"列举访问凭证"},{"name":"listClusterrolebindings","description":"列举K8S集群角色绑定"},{"name":"listClusterroles","description":"列举K8S集群角色"},{"name":"listGroups","description":"列举用户组"},{"name":"listIdentityproviders","description":"列举IDP"},{"name":"listLocalgroupUsers","description":"列举用户组用户"},{"name":"listLocalgroups","description":"列举用户组"},{"name":"listLocalidentities","description":"列举用户"},{"name":"listLocalidentityGroups","description":"列举用户用户组"},{"name":"listLocalidentityPolicies","description":"列举用户策略"},{"name":"listLocalidentityRoles","description":"列举用户角色"},{"name":"listPolicies","description":"列举策略"},{"name":"listPolicyGroups","description":"列举策略用户组"},{"name":"listPolicyUsers","description":"列举策略用户"},{"name":"listRoleGroups","description":"列举角色用户组"},{"name":"listRolePolicybinding","description":"列举角色绑定策略"},{"name":"listRoleUsers","description":"列举角色用户"},{"name":"listRolebindings","description":"列举K8S角色绑定"},{"name":"listRoles","description":"列举角色"},{"name":"listUsers","description":"列举用户"},{"name":"updateApikey","description":"修改访问凭证"},{"name":"updateApikeyStatus","description":"修改访问凭证状态"},{"name":"updateClusterrole","description":"修改K8S集群角色"},{"name":"updateClusterrolebinding","description":"修改K8S集群角色绑定"},{"name":"updateIdentityprovider","description":"修改IDP"},{"name":"updateLocalgroup","description":"修改用户组"},{"name":"updateLocalgroupStatus","description":"修改用户组状态"},{"name":"updateLocalidentity","description":"修改用户"},{"name":"updateLocalidentityStatus","description":"修改用户状态"},{"name":"updatePolicy","description":"修改策略"},{"name":"updatePolicyStatus","description":"修改策略状态"},{"name":"updateRole","description":"修改角色"},{"name":"updateRoleStatus","description":"修改角色状态"},{"name":"updateRolebinding","description":"修改K8S角色绑定"}]}},{"metadata":{"name":"volume","creationTimestamp":null},"Spec":{"displayName":"持久存储","description":"持久存储管理","actions":[{"name":"createPersistentvolume","description":"创建持久存储"},{"name":"createPersistentvolumeclaim","description":"创建持久存储声明"},{"name":"createStorageclass","description":"创建Storageclass"},{"name":"createVolumeattachment","description":"创建Volumeattachment"},{"name":"deletePersistentvolume","description":"删除持久存储"},{"name":"deletePersistentvolumeclaim","description":"删除持久存储声明"},{"name":"deleteStorageclass","description":"删除Storageclass"},{"name":"deleteVolumeattachment","description":"删除Volumeattachment"},{"name":"getPersistentvolume","description":"获取持久存储"},{"name":"getPersistentvolumeStatus","description":"获取持久存储状态"},{"name":"getPersistentvolumeclaim","description":"获取持久存储声明"},{"name":"getPersistentvolumeclaimStatus","description":"获取持久存储声明状态"},{"name":"getStorageclass","description":"获取Storageclass"},{"name":"getVolumeattachment","description":"获取Volumeattachment"},{"name":"listPersistentvolumeEvents","description":"列举持久存储事件"},{"name":"listPersistentvolumeclaimEvents","description":"列举持久存储声明事件"},{"name":"listPersistentvolumeclaims","description":"列举持久存储声明"},{"name":"listPersistentvolumes","description":"列举持久存储"},{"name":"listStorageclassEvents","description":"列举Storageclass事件"},{"name":"listStorageclasses","description":"列举Storageclass"},{"name":"listVolumeattachments","description":"列举Volumeattachment"},{"name":"updatePersistentvolume","description":"修改持久存储"},{"name":"updatePersistentvolumeStatus","description":"修改持久存储状态"},{"name":"updatePersistentvolumeclaim","description":"修改持久存储声明"},{"name":"updatePersistentvolumeclaimStatus","description":"修改持久存储声明状态"},{"name":"updateStorageclass","description":"修改Storageclass"},{"name":"updateVolumeattachment","description":"修改Volumeattachment"}]}}]
  tke-auth-controller.toml: |
    [secure_serving]
    tls_cert_file = "/app/certs/server.crt"
    tls_private_key_file = "/app/certs/server.key"

    [client]

      [client.auth]
      api_server = "https://tke-auth-api"
      api_server_client_config = "/app/conf/tke-auth-config.yaml"

    [features]
      category_path = "/app/conf/category.json"
      policy_path = "/app/conf/policy.json"
      tenant_admin = "{{ .AdminUsername }}"
      tenant_admin_secret = "{{ .AdminPassword }}"

  tke-auth-config.yaml: |
    apiVersion: v1
    kind: Config
    clusters:
      - name: tke
        cluster:
          certificate-authority: /app/certs/ca.crt
          server: https://tke-auth-api
    users:
      - name: admin-cert
        user:
          client-certificate: /app/certs/admin.crt
          client-key: /app/certs/admin.key
    current-context: tke
    contexts:
      - context:
          cluster: tke
          user: admin-cert
        name: tke

